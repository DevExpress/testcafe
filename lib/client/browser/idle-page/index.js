!function(c){"use strict";var f,d,r,p,_,o={".js":[],".json":[],".css":[],".html":[]},u="function"==typeof require?require:null;return p=function(t){var n=new Error("Could not find module '"+t+"'");return n.code="MODULE_NOT_FOUND",n},_=function(t,n,e){var i,r;if("function"==typeof t[n+e])return n+e;for(i=0;r=o[e][i];++i)if("function"==typeof t[n+r])return n+r;return null},f=function(t,n,e,i,r,o){var s,a,c,u,l,h;for("."!==(s=(e=e.split("/")).pop())&&".."!==s||(e.push(s),s="");null!=(a=e.shift());)if(a&&"."!==a&&(".."===a?(t=n.pop(),o=o.slice(0,o.lastIndexOf("/"))):(n.push(t),t=t[a],o+="/"+a),!t))throw p(i);if(s&&"function"!=typeof t[s]&&((h=_(t,s,".js"))||(h=_(t,s,".json")),h||(h=_(t,s,".css")),h||(h=_(t,s,".html")),h?s=h:2!==r&&"object"==typeof t[s]&&(n.push(t),t=t[s],o+="/"+s,s="")),!s)return 1!==r&&t[":mainpath:"]?f(t,n,t[":mainpath:"],i,1,o):f(t,n,"index",i,2,o);if(!(l=t[s]))throw p(i);return l.hasOwnProperty("module")?l.module.exports:(c={},l.module=u={exports:c,id:o+"/"+s},l.call(c,c,u,d(t,n,o)),u.exports)},r=function(t,n,e,i){var r,o=e,s=e.charAt(0),a=0;if("/"===s){if(o=o.slice(1),!(t=c["/"])){if(u)return u(e);throw p(e)}i="/",n=[]}else if("."!==s){if(r=o.split("/",1)[0],!(t=c[r])){if(u)return u(e);throw p(e)}i=r,n=[],(o=o.slice(r.length+1))||((o=t[":mainpath:"])?a=1:(o="index",a=2))}return f(t,n,o,e,a,i)},(d=function(n,e,i){return function(t){return r(n,[].concat(e),t,i)}})(c,[],"")}({pinkie:{"index.js":function(t,n,e){var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o="pending",s="settled",a="fulfilled",c="rejected",u=function(){},l="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,h="undefined"==typeof setImmediate?setTimeout:setImmediate,f=[];function d(){for(var t=0;t<f.length;t++)f[t][0](f[t][1]);i=!(f=[])}function p(t,n){f.push([t,n]),i||(i=!0,h(d,0))}function _(t){var n=t.owner,e=n._state,i=n._data,r=t[e],o=t.then;if("function"==typeof r){e=a;try{i=r(i)}catch(t){v(o,t)}}m(o,i)||(e===a&&y(o,i),e===c&&v(o,i))}function m(n,e){var i;try{if(n===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"===(void 0===e?"undefined":r(e)))){var t=e.then;if("function"==typeof t)return t.call(e,function(t){i||(i=!0,e===t?w(n,t):y(n,t))},function(t){i||(i=!0,v(n,t))}),!0}}catch(t){return i||v(n,t),!0}return!1}function y(t,n){t!==n&&m(t,n)||w(t,n)}function w(t,n){t._state===o&&(t._state=s,t._data=n,p(S,t))}function v(t,n){t._state===o&&(t._state=s,t._data=n,p(x,t))}function g(t){t._then=t._then.forEach(_)}function S(t){t._state=a,g(t)}function x(t){t._state=c,g(t),!t._handled&&l&&global.process.emit("unhandledRejection",t._data,t)}function C(t){global.process.emit("rejectionHandled",t)}function E(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof E==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(t,n){function e(t){v(n,t)}try{t(function(t){y(n,t)},e)}catch(t){e(t)}}(t,this)}E.prototype={constructor:E,_state:o,_then:null,_data:void 0,_handled:!1,then:function(t,n){var e={owner:this,then:new this.constructor(u),fulfilled:t,rejected:n};return!n&&!t||this._handled||(this._handled=!0,this._state===c&&l&&p(C,this)),this._state===a||this._state===c?p(_,e):this._then.push(e),e.then},catch:function(t){return this.then(null,t)}},E.all=function(a){if(!Array.isArray(a))throw new TypeError("You must pass an array to Promise.all().");return new E(function(e,t){var i=[],r=0;function n(n){return r++,function(t){i[n]=t,--r||e(i)}}for(var o,s=0;s<a.length;s++)(o=a[s])&&"function"==typeof o.then?o.then(n(s),t):i[s]=o;r||e(i)})},E.race=function(r){if(!Array.isArray(r))throw new TypeError("You must pass an array to Promise.race().");return new E(function(t,n){for(var e,i=0;i<r.length;i++)(e=r[i])&&"function"==typeof e.then?e.then(t,n):t(e)})},E.resolve=function(n){return n&&"object"===(void 0===n?"undefined":r(n))&&n.constructor===E?n:new E(function(t){t(n)})},E.reject=function(e){return new E(function(t,n){n(e)})},n.exports=E}},testcafe:{src:{browser:{connection:{"command.js":function(t,n,e){t.__esModule=!0,t.default={run:"run",idle:"idle"},n.exports=t.default},"status.js":function(t,n,e){t.__esModule=!0,t.default={ok:"ok",closing:"closing"},n.exports=t.default}}},client:{browser:{"idle-page":{"index.js":function(t,n,e){var r=function(t){{if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}}(e("../")),o=i(e("./status-indicator")),s=i(e("../../../browser/connection/command"));function i(t){return t&&t.__esModule?t:{default:t}}var a=function(){return new XMLHttpRequest},c=function(){function i(t,n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),this.statusUrl=t,this.statusIndicator=new o.default,r.startHeartbeat(n,a),r.startInitScriptExecution(e,a),this._checkStatus(),document.title="["+document.location.toString()+"]"}return i.prototype._checkStatus=function(){var n=this;r.checkStatus(this.statusUrl,a).then(function(t){t.command.cmd===s.default.idle&&window.setTimeout(function(){return n._checkStatus()},1e3)}).catch(function(){return n.statusIndicator.showDisconnection()})},i}();window.IdlePage=c},"status-indicator.js":function(t,n,e){t.__esModule=!0;var i=.75,o=.7,s=1.025,a=.575;function c(t){return t*Math.PI/180}function u(t){return t+"px"}function l(t,n){return{x:Math.round(t.x-n),y:Math.round(t.y-n)}}var r=function(){function r(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,r),this.connected=!0,this.canvas=document.getElementsByClassName("spinner")[0],this.canvasContext=this.canvas.getContext("2d"),this.spinnerAnimationInterval=null,this.rotationAngle=0,this.size=null,this.spinnerCenter=null,this.gradient=null,this._setSize(),this._setFontSize(),this._setSpinnerGradient(),r._createStatusMessage(this.connected),r._alignContainerVertically(),this._drawSpinner(this.connected,0),this._watchWindowResize()}return r._getContainer=function(){return document.getElementsByClassName("container")[0]},r._getStatusElementSpan=function(){return document.getElementsByClassName("status")[0].children[0]},r._createStatusMessage=function(t){var n=r._getStatusElementSpan();n.textContent=t?"CONNECTED":"DISCONNECTED",n.className=t?"connected":"disconnected"},r._alignContainerVertically=function(){var t=document.getElementsByClassName("page-background")[0],n=r._getContainer(),e=Math.ceil((t.offsetHeight-n.offsetHeight)/2);0<e&&(n.style.marginTop=u(e))},r.prototype._setSize=function(){var t=window.document.documentElement,n=Math.min(t.clientWidth,t.clientHeight),e=r._getContainer();Math.round(Math.min(400,.8*n))!==this.size&&(this.size=Math.round(Math.min(400,.8*n)),this.spinnerCenter=this.size/2,e.style.width=u(this.size),e.style.height=u(this.size),this.canvas.width=this.canvas.height=this.size)},r.prototype._setFontSize=function(){var t=document.getElementsByClassName("user-agent")[0].children[0],n=r._getStatusElementSpan(),e=Math.round(.03*this.size+3.5),i=e+6;t.style.fontSize=u(e),t.style.lineHeight=u(i),t.style.maxHeight=u(2*i),n.style.fontSize=u(e),n.style.lineHeight=u(i-1)},r.prototype._watchWindowResize=function(){var n=this;window.onresize=function(){var t=n.size;n._setSize(),n._setFontSize(),r._alignContainerVertically(),t!==n.size&&(n.connected&&n._setSpinnerGradient(),n._drawSpinner(n.connected,n.rotationAngle))}},r.prototype._drawSpinner=function(t,n){var e=this;this._clearCanvas(),clearInterval(this.spinnerAnimationInterval),t?(this.spinnerAnimationInterval=window.setInterval(function(){e._clearCanvas(),e._rotateSpinner(),e._drawCircle(e.gradient,240,n)},30),this._drawCircle(this.gradient,240,n)):this._drawCircle("#882E24",360,0)},r.prototype._drawCircle=function(t,n,e){var i=this.spinnerCenter-4;this.canvasContext.beginPath(),this.canvasContext.lineWidth=8,this.canvasContext.strokeStyle=t,this.canvasContext.arc(this.spinnerCenter,this.spinnerCenter,i,c(e),c(e+n),!1),this.canvasContext.stroke()},r.prototype._rotateSpinner=function(){this.rotationAngle+=7,this.rotationAngle=360<this.rotationAngle?this.rotationAngle%360:this.rotationAngle,this.canvasContext.translate(this.spinnerCenter,this.spinnerCenter),this.canvasContext.rotate(c(7)),this.canvasContext.translate(-this.spinnerCenter,-this.spinnerCenter)},r.prototype._getRotatedGradientPoints=function(t){var n,e,i,r=l(t,this.spinnerCenter);return n=r,e=this.rotationAngle,i=c(e),r=l(r={x:Math.round(n.x*Math.cos(i)-n.y*Math.sin(i)),y:Math.round(n.x*Math.sin(i)+n.y*Math.cos(i))},-this.spinnerCenter)},r.prototype._setSpinnerGradient=function(){var t={x:Math.round(this.size*i),y:Math.round(this.size*o)},n={x:Math.round(this.size*s),y:Math.round(this.size*a)};0!==this.rotationAngle&&(t=this._getRotatedGradientPoints(t),n=this._getRotatedGradientPoints(n));var e=this.canvasContext.createLinearGradient(t.x,t.y,n.x,n.y);e.addColorStop(0,"#28687F"),e.addColorStop(1,"#181818"),this.gradient=e},r.prototype._clearCanvas=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.showDisconnection=function(){this.connected=!1,r._createStatusMessage(this.connected),this._drawSpinner(this.connected,0)},r}();t.default=r,n.exports=t.default}},"index.js":function(exports,module,require){exports.__esModule=!0,exports.startHeartbeat=startHeartbeat,exports.startInitScriptExecution=startInitScriptExecution,exports.stopInitScriptExecution=stopInitScriptExecution,exports.redirect=redirect,exports.checkStatus=checkStatus;var _pinkie=require("pinkie"),_pinkie2=_interopRequireDefault(_pinkie),_command=require("../../browser/connection/command"),_command2=_interopRequireDefault(_command),_status=require("../../browser/connection/status"),_status2=_interopRequireDefault(_status);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var HEARTBEAT_INTERVAL=2e3,allowInitScriptExecution=!1;function sendXHR(i,r){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET",s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return new _pinkie2.default(function(t,n){var e=r();e.open(o,i,!0),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?t(e.responseText?JSON.parse(e.responseText):""):n("disconnected"))},e.send(s)})}function isCurrentLocation(t){return document.location.href.toLowerCase()===t.toLowerCase()}function startHeartbeat(t,n){function e(){sendXHR(t,n).then(function(t){t.code!==_status2.default.closing||isCurrentLocation(t.url)||(stopInitScriptExecution(),document.location=t.url)})}window.setInterval(e,HEARTBEAT_INTERVAL),e()}function executeInitScript(initScriptUrl,createXHR){allowInitScriptExecution&&sendXHR(initScriptUrl,createXHR).then(function(res){return res.code?sendXHR(initScriptUrl,createXHR,"POST",JSON.stringify(eval(res.code))):null}).then(function(){window.setTimeout(function(){return executeInitScript(initScriptUrl,createXHR)},1e3)})}function startInitScriptExecution(t,n){allowInitScriptExecution=!0,executeInitScript(t,n)}function stopInitScriptExecution(){allowInitScriptExecution=!1}function redirect(t){stopInitScriptExecution(),document.location=t.url}function checkStatus(t,n,e){var i=(e||{}).manualRedirect;return sendXHR(t,n).then(function(t){var n=(t.cmd===_command2.default.run||t.cmd===_command2.default.idle)&&!isCurrentLocation(t.url);return n&&!i&&redirect(t),{command:t,redirecting:n}})}}}}}}})("testcafe/src/client/browser/idle-page/index");