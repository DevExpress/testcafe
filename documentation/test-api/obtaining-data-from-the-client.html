<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <title>Obtaining Data from the Client | TestCafe</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  
  <meta property="og:image" content="https://raw.githubusercontent.com/DevExpress/testcafe-gh-page-assets/master/src/images/testcafe-ogp-icon.png">
  <meta property="og:type" content="website" />
  <meta property="og:url" content="http://devexpress.github.io/testcafe/documentation/test-api/obtaining-data-from-the-client.html" />
  <meta property="og:title" content="Obtaining Data from the Client | TestCafe" />

  <link rel="shortcut icon" href="/testcafe/favicon.ico">
  <link rel="stylesheet" href="/testcafe/css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/docco.min.css">
  <link rel="canonical" href="http://devexpress.github.io/testcafe/documentation/test-api/obtaining-data-from-the-client.html">
  <link rel="alternate" type="application/rss+xml" title="TestCafe" href="http://devexpress.github.io/testcafe/feed.xml">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
  <script>
      document.addEventListener('DOMContentLoaded', function (e) {
          hljs.initHighlightingOnLoad();
      });
  </script>

  
  <script>
    // Google Analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83678642-1', 'auto');
    ga('send', 'pageview');
  </script>
  

  
  

  

  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/0.6.12/css/perfect-scrollbar.min.css">
    <script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/0.6.12/js/perfect-scrollbar.min.js"></script>
    <script>
        var MIN_BODY_WIDTH = 900;
        var FOOTER_HEIGHT  = 63;
        var HEADER_HEIGHT  = 52;

        var nav            = null;
        var isMobileDevice = window.screen.width < 800 || window.screen.height < 800;

        function setNavTopPosition () {
            var isMobileZoomed = isMobileDevice && window.innerWidth !== document.body.scrollWidth;

            if (document.body.clientWidth > MIN_BODY_WIDTH) {
                if (nav.style.top !== HEADER_HEIGHT + 'px') {
                    nav.style.top = HEADER_HEIGHT + 'px';
                    Ps.update(nav);
                }
            }
            else if(!isMobileZoomed) {
                var top = window.pageYOffset <= HEADER_HEIGHT ? HEADER_HEIGHT - window.pageYOffset + 'px' : '0';

                if (nav.style.top !== top) {
                    nav.style.top = top;
                    Ps.update(nav);
                }
            }
        }

        function setNavBottomPosition () {
            var footerVisibleHeight = FOOTER_HEIGHT - document.body.scrollHeight + window.pageYOffset +
                                      document.body.clientHeight;

            if (footerVisibleHeight > 0) {
                if (nav.style.bottom !== footerVisibleHeight + 'px') {
                    nav.style.bottom = footerVisibleHeight + 'px';
                    Ps.update(nav);
                }
            }
            else if (nav.style.bottom !== '0') {
                nav.style.bottom = '0';
                Ps.update(nav);
            }
        }

        function updatePosition () {
            if (isMobileDevice)
                changeBodyHeight();
            else
                nav.style.marginLeft = '-' + window.pageXOffset + 'px';

            setNavBottomPosition();
            setNavTopPosition();
        }
        
        function changeBodyHeight () {
            if (document.body.style.height !== window.innerHeight + 'px')
                document.body.style.height = window.innerHeight + 'px';
        }
        
        function initScrollBar() {
            Ps.initialize(nav);
            
            window.addEventListener('resize', function () {
                Ps.update(nav);
            });
        }

        function initNav() {
            initScrollBar();
            updatePosition();
            window.addEventListener('scroll', updatePosition);
            window.addEventListener('resize', updatePosition);
        }

        document.addEventListener('DOMContentLoaded', function (e) {
            nav = document.querySelector('.doc-nav');

            if(nav)
                initNav(nav);
        });
    </script>
  
    <script>
        function initHeader(siteHeader, contentWrapper) {
            var MIN_BODY_WIDTH = 900;

            function updateHeader() {
                var bodyMinimized = document.body.clientWidth === MIN_BODY_WIDTH;
                
                

                siteHeader.style.position = bodyMinimized ? 'static' : '';

                if(contentWrapper)
                    contentWrapper.style.paddingTop = bodyMinimized ? '0' : '';
            }

            updateHeader();
            window.addEventListener('scroll', updateHeader);
            window.addEventListener('resize', updateHeader);
        }
        document.addEventListener('DOMContentLoaded', function (e) {
            var contentWrapper = document.querySelector('.container');
            var siteHeader     = document.querySelector('.site-header');

            if(siteHeader) 
                initHeader(siteHeader, contentWrapper);
        });
    </script>
</head>


  <body>
    <div class="page-content-wrapper">

      <header class="site-header minimized">
  <div class="site-header-content">
    <a class="site-logo" href="/testcafe/"></a>

    <nav class="site-nav">
      <div class="trigger">
        
          
          <a class="page-link active" href="/testcafe/documentation/getting-started/">Documentation</a>
          <span class="page-link-separator">|</span>
        
          
          <a class="page-link " href="https://github.com/DevExpress/testcafe">GitHub</a>
          <span class="page-link-separator">|</span>
        
          
          <a class="page-link " href="/testcafe/blog/">Blog</a>
          <span class="page-link-separator">|</span>
        
          
          <a class="page-link " href="https://github.com/DevExpress/testcafe/issues">Issues</a>
          <span class="page-link-separator">|</span>
        
          
          <a class="page-link " href="https://testcafe-discuss.devexpress.com/">Discuss</a>
          <span class="page-link-separator">|</span>
        
          
          <a class="page-link " href="https://twitter.com/dxtestcafe">Twitter</a>
          <span class="page-link-separator">|</span>
        
      </div>
    </nav>
  </div>
</header>


      <div class="container">
    	<nav class="doc-nav">	
		<div class="doc-nav-content">
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/getting-started/"  >GETTING STARTED</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/"  >USING TESTCAFE</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/installing-testcafe.html"  >Installing TestCafe</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/command-line-interface.html"  >Command Line Interface</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/programming-interface/"  >Programming Interface</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/programming-interface/testcafe.html"  >TestCafe Class</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/programming-interface/browserconnection.html"  >BrowserConnection Class</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/programming-interface/runner.html"  >Runner Class</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/programming-interface/createtestcafe.html"  >createTestCafe Factory</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/common-concepts/"  >Common Concepts</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/common-concepts/browser-support.html"  >Browser Support</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/using-testcafe/common-concepts/reporters.html"  >Reporters</a>
		
    </li>

</ul>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/"  >TEST API</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html"  >Test Code Structure</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#fixtures"  >Fixtures</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#tests"  >Tests</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#test-controller"  >Test Controller</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#specifying-the-start-webpage"  >Specifying the Start Webpage</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#initialization-and-clean-up"  >Initialization and Clean-Up</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#sharing-variables-between-the-hooks-and-test-code"  >Sharing Variables Between the Hooks and Test Code</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/test-code-structure.html#skipping-tests"  >Skipping Tests</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/"  >Actions</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/click.html"  >Click</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/double-click.html"  >Double Click</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/right-click.html"  >Right Click</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/drag-element.html"  >Drag Element</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/hover.html"  >Hover</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/select-text.html"  >Select Text</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/type-text.html"  >Type Text</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/press-key.html"  >Press Key</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/navigate.html"  >Navigate</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/take-screenshot.html"  >Take Screenshot</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/upload.html"  >Upload</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/resize-window.html"  >Resize Window</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/actions/action-options.html"  >Action Options</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/selecting-page-elements/"  >Selecting Page Elements</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/selecting-page-elements/selectors.html"  >Selectors</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/selecting-page-elements/selector-options.html"  >Selector Options</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/selecting-page-elements/dom-node-state.html"  >DOM Node State</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/assertions/"  >Assertions</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/assertions/assertion-api.html"  >Assertion API</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/obtaining-data-from-the-client.html" class="active" >Obtaining Data from the Client</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/http-authentication.html"  >HTTP Authentication</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/pausing-the-test.html"  >Pausing the Test</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/handling-native-dialogs.html"  >Handling Native Dialogs</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/working-with-iframes.html"  >Working with &lt;iframes&gt;</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/test-api/a-z.html"  >A-Z Index</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/"  >EXTENDING TESTCAFE</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/reporter-plugin/"  >Reporter Plugin</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/reporter-plugin/reporter-methods.html"  >Reporter Methods</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/reporter-plugin/helpers.html"  >Helpers</a>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/browser-provider-plugin/"  >Browser Provider Plugin</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/extending-testcafe/browser-provider-plugin/browser-provider-methods.html"  >Browser Provider Methods</a>
		
    </li>

</ul>
		
    </li>

</ul>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/"  >RECIPES</a>
		
			<ul>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/running-tests-in-firefox-and-chrome-using-travis-ci.html"  >Running Tests in Firefox and Chrome Using Travis CI</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/running-tests-using-travis-ci-and-sauce-labs.html"  >Running Tests Using Travis CI and Sauce Labs</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/test-static-html-pages.html"  >Test Static HTML Pages</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/testing-on-remote-computers-and-mobile-devices.html"  >Testing on Remote Computers and Mobile Devices</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/using-page-model.html"  >Using Page Model</a>
		
    </li>

    <li>
		    
		
<a href="/testcafe/documentation/recipes/using-testcafe-with-gulp.html"  >Using TestCafe with Gulp</a>
		
    </li>

</ul>
		
    </li>

</ul>
		</div>
	</nav>


<main>
	<article class="doc">
		<div class="post-content">

			<h1>Obtaining Data from the Client</h1>
<p>TestCafe allows you to create <em>client functions</em> that can return any
serializable value from the client side, like the current URL
or custom data calculated by a client script.</p>
<blockquote class="important"><div class="blockquote-content"><p>Do not modify the tested webpage within client functions.
To interact with the page, use <a href="actions/">test actions</a>.</p>
</div></blockquote>
<p>This topic contains the following sections.</p>

<ul>
<li><a href="#creating-client-functions">Creating Client Functions</a></li>
<li><a href="#executing-client-functions">Executing Client Functions</a></li>
<li><a href="#options">Options</a></li>
<li><a href="#one-time-client-code-execution">One-Time Client Code Execution</a></li>
<li><a href="#calling-client-functions-from-nodejs-callbacks">Calling Client Functions from Node.js Callbacks</a></li>
<li><a href="#limitations">Limitations</a></li>
</ul>
<h2><a class="anchor" name="creating-client-functions"></a>Creating Client Functions <a class="permalink" href="#creating-client-functions">#</a></h2>
<p>To create a client function, use the <code>ClientFunction</code> constructor.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ClientFunction( fn [, options] )
</code></pre></div>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>fn</code></td>
<td>Function</td>
<td>A function to be executed on the client side.</td>
</tr>
<tr>
<td><code>options</code>&#160;<em>(optional)</em></td>
<td>Object</td>
<td>See <a href="#options">Options</a>.</td>
</tr>
</tbody></table>
<blockquote class="important"><div class="blockquote-content"><p>Client functions cannot return DOM nodes. Use <a href="selecting-page-elements/selectors.html">selectors</a> for this.</p>
</div></blockquote>
<p>The following example shows how to create a client function.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ClientFunction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'testcafe'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">getWindowLocation</span> <span class="o">=</span> <span class="nx">ClientFunction</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">);</span>
</code></pre></div><h2><a class="anchor" name="executing-client-functions"></a>Executing Client Functions <a class="permalink" href="#executing-client-functions">#</a></h2>
<p>To execute a client function, call it with the <code>await</code> keyword.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ClientFunction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'testcafe'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">getWindowLocation</span> <span class="o">=</span> <span class="nx">ClientFunction</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">);</span>

<span class="nx">fixture</span> <span class="err">`</span><span class="nx">My</span> <span class="nx">fixture</span><span class="err">`</span>
    <span class="p">.</span><span class="nx">page</span> <span class="err">`</span><span class="nx">http</span><span class="err">:</span><span class="c1">//www.example.com/`;</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'My Test'</span><span class="p">,</span> <span class="nx">async</span> <span class="nx">t</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">location</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">getWindowLocation</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div><h2><a class="anchor" name="options"></a>Options <a class="permalink" href="#options">#</a></h2>
<p>You can pass the following options to the
<a href="#creating-client-functions">ClientFunction constructor</a> and the
<a href="#one-time-client-code-execution">t.eval</a> function.</p>
<h3><a class="anchor" name="optionsdependencies"></a>options.dependencies <a class="permalink" href="#optionsdependencies">#</a></h3>
<p><strong>Type</strong>: Object</p>

<p>Contains functions, variables or objects used by the client function internally.
Properties of the <code>dependencies</code> object will be added to the client function&#39;s scope as variables.</p>

<p>The following sample demonstrates a client function (<code>getArticleHeaderHTML</code>) that
calls a <a href="selecting-page-elements/selectors.html">selector</a> (<code>articleHeader</code>) internally.
This selector is passed to <code>getArticleHeaderHTML</code> as a dependency.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span><span class="p">,</span> <span class="nx">ClientFunction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'testcafe'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">articleHeader</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">'#article-header'</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">getArticleHeaderHTML</span> <span class="o">=</span> <span class="nx">ClientFunction</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">articleHeader</span><span class="p">().</span><span class="nx">innerHTML</span><span class="p">,</span> <span class="p">{</span>
     <span class="na">dependencies</span><span class="p">:</span> <span class="p">{</span> <span class="nx">articleHeader</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><blockquote><div class="blockquote-content"><p>When a client function calls a <a href="selecting-page-elements/selectors.html">selector</a> internally,
the selector does not wait for the element to appear in the DOM
but is executed at once, like a client function.</p>
</div></blockquote><h3><a class="anchor" name="optionsboundtestrun"></a>options.boundTestRun <a class="permalink" href="#optionsboundtestrun">#</a></h3>
<p><strong>Type</strong>: Object</p>

<p>If you need to call a client function from a Node.js callback,
assign the current <a href="test-code-structure.html#test-controller">test controller</a>
to the <code>boundTestRun</code> option.</p>

<p>For details, see <a href="#calling-client-functions-from-nodejs-callbacks">Calling Client Functions from Node.js Callbacks</a>.</p>
<h3><a class="anchor" name="overwriting-options"></a>Overwriting Options <a class="permalink" href="#overwriting-options">#</a></h3>
<p>You can overwrite client function options by using the ClientFunction&#39;s <code>with</code> function.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">clientFunction.with( options ) → ClientFunction
</code></pre></div>
<p><code>with</code> returns a new client function with a different set of options that includes options
from the original function and new <code>options</code> that overwrite the original ones.</p>

<p>The sample below shows how to overwrite the client function options.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span><span class="p">,</span> <span class="nx">ClientFunction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'testcafe'</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">option</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">'option'</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">thirdOption</span> <span class="o">=</span> <span class="nx">option</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">getThirdOptionHTML</span> <span class="o">=</span> <span class="nx">ClientFunction</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">option</span><span class="p">().</span><span class="nx">innerHTML</span><span class="p">,</span> <span class="p">{</span>
     <span class="na">dependencies</span><span class="p">:</span> <span class="p">{</span> <span class="na">option</span><span class="p">:</span> <span class="nx">thirdOption</span> <span class="p">}</span>
<span class="p">});</span>

<span class="kr">const</span> <span class="nx">fourthOption</span> <span class="o">=</span> <span class="nx">option</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">getFourthOptionHTML</span> <span class="o">=</span> <span class="nx">getThirdOptionHTML</span><span class="p">.</span><span class="kd">with</span><span class="p">({</span>
    <span class="na">dependencies</span><span class="p">:</span> <span class="p">{</span> <span class="na">option</span><span class="p">:</span> <span class="nx">fourthOption</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><h2><a class="anchor" name="one-time-client-code-execution"></a>One-Time Client Code Execution <a class="permalink" href="#one-time-client-code-execution">#</a></h2>
<p>To create a client function and immediately execute it without saving it,
use the <code>eval</code> method of the <a href="test-code-structure.html#test-controller">test controller</a>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">t.eval( fn [, options] )
</code></pre></div>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>fn</code></td>
<td>Function</td>
<td>A function to be executed on the client side.</td>
</tr>
<tr>
<td><code>options</code>&#160;<em>(optional)</em></td>
<td>Object</td>
<td>See <a href="#options">Options</a>.</td>
</tr>
</tbody></table>

<p>The following example shows how to get the document&#39;s URI with <code>t.eval</code>.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">fixture</span> <span class="err">`</span><span class="nx">My</span> <span class="nx">fixture</span><span class="err">`</span>
    <span class="p">.</span><span class="nx">page</span> <span class="err">`</span><span class="nx">http</span><span class="err">:</span><span class="c1">//www.example.com/`;</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'My Test'</span><span class="p">,</span> <span class="nx">async</span> <span class="nx">t</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">docURI</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">t</span><span class="p">.</span><span class="nb">eval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentURI</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div><h2><a class="anchor" name="calling-client-functions-from-nodejs-callbacks"></a>Calling Client Functions from Node.js Callbacks <a class="permalink" href="#calling-client-functions-from-nodejs-callbacks">#</a></h2>
<p>Client functions need access to the <a href="test-code-structure.html#test-controller">test controller</a> to be executed.
When called right from the test function, they implicitly obtain the test controller.</p>

<p>However, if you need to call a client function from a Node.js callback that fires during the test run,
you will have to manually bind this function to the test controller.</p>

<p>Use the <a href="#optionsboundtestrun">boundTestRun</a> option for this.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">fs</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'fs'</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">ClientFunction</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'testcafe'</span><span class="p">;</span>

<span class="nx">fixture</span> <span class="err">`</span><span class="nx">My</span> <span class="nx">fixture</span><span class="err">`</span>
    <span class="p">.</span><span class="nx">page</span> <span class="err">`</span><span class="nx">http</span><span class="err">:</span><span class="c1">//www.example.com/`;</span>

<span class="kr">const</span> <span class="nx">getDataFromClient</span> <span class="o">=</span> <span class="nx">ClientFunction</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">getSomeData</span><span class="p">());</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'Check client data'</span><span class="p">,</span> <span class="nx">async</span> <span class="nx">t</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">boundGetDataFromClient</span> <span class="o">=</span> <span class="nx">getDataFromClient</span><span class="p">.</span><span class="kd">with</span><span class="p">({</span> <span class="na">boundTestRun</span><span class="p">:</span> <span class="nx">t</span> <span class="p">});</span>

    <span class="kr">const</span> <span class="nx">equal</span> <span class="o">=</span> <span class="nx">await</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'/home/user/tests/reference/clientData.json'</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">boundGetDataFromClient</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">clientData</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">clientData</span><span class="p">)</span> <span class="o">===</span> <span class="nx">data</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">});</span>

    <span class="nx">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">equal</span><span class="p">).</span><span class="nx">ok</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>
<p>This approach only works for Node.js callbacks that fire during the test run. To ensure that the test function
does not finish before the callback is executed, suspend the test until the callback fires. You can do this
by introducing a promise and synchronously waiting for it to complete as shown in the example above.</p>
<h2><a class="anchor" name="limitations"></a>Limitations <a class="permalink" href="#limitations">#</a></h2>
<ul>
<li><p>You cannot use generators or <code>async/await</code> syntax within client functions.</p></li>
<li><p>Client functions cannot access variables defined in the outer scope in test code.
However, you can use arguments to pass data inside these functions, except for self-invoking functions
that cannot take any parameters from the outside.</p>

<p>Likewise, the return value is the only way to obtain data from client functions.</p></li>
</ul>


		</div>
	</article>
</main>
</div>

      <div class="push"></div>
    </div>

    <footer class="site-footer">
    <div class="site-footer-content">
        <div class="footer-col-1">
            <p><strong>TestCafe</strong>: Automated browser testing for the modern web development stack<br/>
            Copyright © 1998-2017 Developer Express Inc.</p>
        </div>
    </div>
</footer>


  </body>

</html>
