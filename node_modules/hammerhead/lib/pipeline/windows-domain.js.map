{"version":3,"sources":["pipeline/windows-domain.js"],"names":[],"mappings":";;;;;;;QAgBsB,MAAM,GAAN,MAAM;;6BAhBH,eAAe;;;;uBACpB,SAAS;;;;AAE7B,IAAI,IAAI,GAAK,kBAAQ,SAAS,CAAC,wBAAa,IAAI,CAAC,CAAC;AAClD,IAAI,MAAM,GAAG,IAAI,CAAC;;AAElB,SAAe,oBAAoB,CAAE,GAAG;QAE5B,UAAU;;;;;;uBAAS,IAAI,CAAC,GAAG,CAAC;;;AAA5B,0BAAU;oDACP,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;;;;;oDAG7B,EAAE;;;;;;;CAEhB;;AAEM,SAAe,MAAM,CAAE,WAAW;;;;oBAChC,MAAM;;;;;;uBAEgB,oBAAoB,CAAC,mBAAmB,CAAC;;;;;uBACzC,oBAAoB,CAAC,UAAU,CAAC;;;;AAFvD,sBAAM;AACF,0BAAM;AACN,+BAAW;;;;;AAInB,2BAAW,CAAC,MAAM,GAAQ,WAAW,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC;AAC9D,2BAAW,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC;;;;;;;CAC3E","file":"pipeline/windows-domain.js","sourcesContent":["import childProcess from 'child_process';\r\nimport Promise from 'promise';\r\n\r\nvar exec   = Promise.denodeify(childProcess.exec);\r\nvar cached = null;\r\n\r\nasync function queryOSForCredential (cmd) {\r\n    try {\r\n        var credential = await exec(cmd);\r\n        return credential.replace(/\\s/g, '');\r\n    }\r\n    catch (err) {\r\n        return '';\r\n    }\r\n}\r\n\r\nexport async function assign (credentials) {\r\n    if (!cached) {\r\n        cached = {\r\n            domain:      await queryOSForCredential('echo %userdomain%'),\r\n            workstation: await queryOSForCredential('hostname')\r\n        };\r\n    }\r\n\r\n    credentials.domain      = credentials.domain || cached.domain;\r\n    credentials.workstation = credentials.workstation || cached.workstation;\r\n}"],"sourceRoot":"../src"}